{% extends 'quotes/base.html' %}

{% block content %}
<div class="container mt-4">
    {% if not user.is_authenticated %}
    <div class="alert alert-info mb-4">
        –ß—Ç–æ–±—ã —Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ <a href="{% url 'login' %}?next={{ request.path }}">–≤–æ–π–¥–∏—Ç–µ</a>
        –∏–ª–∏ <a href="{% url 'register' %}">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>.
    </div>
    {% endif %}

    <div class="card">
        <div class="card-body">
            <blockquote class="blockquote mb-4">
                <p class="font-italic">{{ quote.text }}</p>
                <footer class="blockquote-footer">
                    {% if quote.author %}{{ quote.author }}, {% endif %}
                    <cite>{{ quote.source.name|default:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫" }}</cite>
                </footer>
            </blockquote>

            <div class="d-flex justify-content-between align-items-center mb-3">
                <small class="text-muted">
                    –î–æ–±–∞–≤–ª–µ–Ω–æ: {{ quote.created_at|date:"d.m.Y" }} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                    {{ quote.author.username|default:"–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º" }} |
                    –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {{ quote.views }}
                </small>

                <span class="badge {% if popularity > 0 %}bg-success{% elif popularity < 0 %}bg-danger{% else %}bg-secondary{% endif %}">
                    –†–µ–π—Ç–∏–Ω–≥: {{ popularity }}
                </span>
            </div>

            {% if user.is_authenticated %}
            <div class="btn-group" role="group">
                <form method="post" action="{% url 'like_dislike' quote.id 'like' %}">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <button type="submit" class="btn btn-outline-primary {% if user in quote.liked_by.all %}active{% endif %}">
                        üëç {{ quote.liked_by.count }}
                    </button>
                </form>

                <form method="post" action="{% url 'like_dislike' quote.id 'dislike' %}">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <button type="submit" class="btn btn-outline-danger {% if user in quote.disliked_by.all %}active{% endif %}">
                        üëé {{ quote.disliked_by.count }}
                    </button>
                </form>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}